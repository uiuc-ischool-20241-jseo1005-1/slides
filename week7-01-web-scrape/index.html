<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Web scraping</title>
    <meta charset="utf-8" />
    <meta name="author" content="JooYoung Seo" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/font-awesome/css/all.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/v4-shims.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding/datatables.js"></script>
    <script src="libs/jquery/jquery-3.6.0.min.js"></script>
    <link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="../xaringan-themer.css" type="text/css" />
    <link rel="stylesheet" href="../slides.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Web scraping
## IS 407
### JooYoung Seo

---








class: middle

# Scraping the web

---

## Scraping the web: what? why?

- Increasing amount of data is available on the web
--

- These data are provided in an unstructured format: you can always copy&amp;paste, but it's time-consuming and prone to errors

--
- Web scraping is the process of extracting this information automatically and transform it into a structured dataset

--
- Two different scenarios:
    - Screen scraping: extract data from source code of website, with html parser (easy) or regular expression matching (less easy).
    - Web APIs (application programming interface): website offers a set of structured http requests that return JSON or XML files.

---

class: middle

# Web Scraping with rvest

---

## Hypertext Markup Language

- Most of the data on the web is still largely available as HTML 
- It is structured (hierarchical / tree based), but it''s often not available in a form useful for analysis (flat / tidy).

```html
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;This is a title&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;p align="center"&gt;Hello world!&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;
```

---

## rvest

.pull-left[
- The **rvest** package makes basic processing and manipulation of HTML data straight forward
- It's designed to work with pipelines built with `%&gt;%`
]
.pull-right[
&lt;img src="img/rvest.png" width="230" style="display: block; margin: auto 0 auto auto;" /&gt;
]

---

## Core rvest functions

- `read_html`   - Read HTML data from a url or character string
- `html_node `  - Select a specified node from HTML document
- `html_nodes`  - Select specified nodes from HTML document
- `html_table`  - Parse an HTML table into a data frame
- `html_text`   - Extract tag pairs' content
- `html_name`   - Extract tags' names
- `html_attrs`  - Extract all of each tag's attributes
- `html_attr`   - Extract tags' attribute value by name

---

## SelectorGadget

.pull-left-narrow[
- Open source tool that eases CSS selector generation and discovery
- Easiest to use with the [Chrome Extension](https://chrome.google.com/webstore/detail/selectorgadget/mhjhnkcfbdhnjickkkdbjoemdmbfginb) 
- Find out more on the [SelectorGadget vignette](https://rvest.tidyverse.org/articles/selectorgadget.html)
]
.pull-right-wide[
&lt;img src="img/selector-gadget/selector-gadget.png" width="75%" style="display: block; margin: auto;" /&gt;
]

---

## Using the SelectorGadget

&lt;img src="img/selector-gadget/selector-gadget.gif" width="80%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="img/selector-gadget/selector-gadget-1.png" width="95%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="img/selector-gadget/selector-gadget-2.png" width="95%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="img/selector-gadget/selector-gadget-3.png" width="95%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="img/selector-gadget/selector-gadget-4.png" width="95%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="img/selector-gadget/selector-gadget-5.png" width="95%" style="display: block; margin: auto;" /&gt;

---

## Using the SelectorGadget

Through this process of selection and rejection, SelectorGadget helps you come up with the appropriate CSS selector for your needs

&lt;img src="img/selector-gadget/selector-gadget.gif" width="65%" style="display: block; margin: auto;" /&gt;

---


class: middle

# Top 250 movies on IMDB

---

## Top 250 movies on IMDB

Take a look at the source code, look for the tag `table` tag:
&lt;br&gt;
http://www.imdb.com/chart/top

.pull-left[
&lt;img src="img/imdb-top-250.png" width="100%" style="display: block; margin: auto;" /&gt;
]
.pull-right[
&lt;img src="img/imdb-top-250-source.png" width="94%" style="display: block; margin: auto;" /&gt;
]


---

## First check if you're allowed!


```r
library(robotstxt)
paths_allowed("http://www.imdb.com")
```

```
## [1] TRUE
```

vs. e.g.


```r
paths_allowed("http://www.facebook.com")
```

```
## [1] FALSE
```

---

## Plan

&lt;img src="img/plan.png" width="90%" style="display: block; margin: auto;" /&gt;

---

## Plan

1. Read the whole page

2. Scrape movie titles and save as `titles` 

3. Scrape years movies were made in and save as `years`

4. Scrape IMDB ratings and save as `ratings`

5. Create a data frame called `imdb_top_250` with variables `title`, `year`, and `rating`

---

class: middle

# Step 1. Read the whole page

---

## Read the whole page


```r
page &lt;- read_html("https://www.imdb.com/chart/top/")
page
```

```
## {html_document}
## &lt;html xmlns:og="http://ogp.me/ns#" xmlns:fb="http://www.facebook.com/2008/fbml"&gt;
## [1] &lt;head&gt;\n&lt;meta http-equiv="Content-Type" content="text/html ...
## [2] &lt;body id="styleguide-v2" class="fixed"&gt;\n            &lt;img  ...
```

---

## A webpage in R

- Result is a list with 2 elements


```r
typeof(page)
```

```
## [1] "list"
```

--

- that we need to convert to something more familiar, like a data frame....


```r
class(page)
```

```
## [1] "xml_document" "xml_node"
```

---

class: middle

# Step 2. Scrape movie titles and save as `titles` 

---

## Scrape movie titles

&lt;img src="img/titles.png" width="70%" style="display: block; margin: auto;" /&gt;

---

## Scrape the nodes

.pull-left[

```r
page %&gt;%
  html_nodes(".titleColumn a")
```

```
## {xml_nodeset (250)}
##  [1] &lt;a href="/title/tt0111161/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
##  [2] &lt;a href="/title/tt0068646/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
##  [3] &lt;a href="/title/tt0071562/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
##  [4] &lt;a href="/title/tt0468569/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
##  [5] &lt;a href="/title/tt0050083/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
##  [6] &lt;a href="/title/tt0108052/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
##  [7] &lt;a href="/title/tt0167260/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
##  [8] &lt;a href="/title/tt0110912/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
##  [9] &lt;a href="/title/tt0060196/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
## [10] &lt;a href="/title/tt0120737/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
## [11] &lt;a href="/title/tt0137523/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
## [12] &lt;a href="/title/tt0109830/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
## [13] &lt;a href="/title/tt1375666/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
## [14] &lt;a href="/title/tt0167261/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
## [15] &lt;a href="/title/tt0080684/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
## [16] &lt;a href="/title/tt0133093/?pf_rd_m=A2FGELUUNOQJNL&amp;amp;pf_ ...
...
```
]
.pull-right[
&lt;img src="img/titles.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Extract the text from the nodes

.pull-left[

```r
page %&gt;%
  html_nodes(".titleColumn a") %&gt;%
  html_text()
```

```
##   [1] "The Shawshank Redemption"                                            
##   [2] "The Godfather"                                                       
##   [3] "The Godfather: Part II"                                              
##   [4] "The Dark Knight"                                                     
##   [5] "12 Angry Men"                                                        
##   [6] "Schindler's List"                                                    
##   [7] "The Lord of the Rings: The Return of the King"                       
##   [8] "Pulp Fiction"                                                        
##   [9] "The Good, the Bad and the Ugly"                                      
##  [10] "The Lord of the Rings: The Fellowship of the Ring"                   
##  [11] "Fight Club"                                                          
##  [12] "Forrest Gump"                                                        
##  [13] "Inception"                                                           
##  [14] "The Lord of the Rings: The Two Towers"                               
##  [15] "Star Wars: Episode V - The Empire Strikes Back"                      
##  [16] "The Matrix"                                                          
...
```
]
.pull-right[
&lt;img src="img/titles.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Save as `titles`

.pull-left[

```r
titles &lt;- page %&gt;%
  html_nodes(".titleColumn a") %&gt;%
  html_text()

titles
```

```
##   [1] "The Shawshank Redemption"                                            
##   [2] "The Godfather"                                                       
##   [3] "The Godfather: Part II"                                              
##   [4] "The Dark Knight"                                                     
##   [5] "12 Angry Men"                                                        
##   [6] "Schindler's List"                                                    
##   [7] "The Lord of the Rings: The Return of the King"                       
##   [8] "Pulp Fiction"                                                        
##   [9] "The Good, the Bad and the Ugly"                                      
##  [10] "The Lord of the Rings: The Fellowship of the Ring"                   
##  [11] "Fight Club"                                                          
##  [12] "Forrest Gump"                                                        
##  [13] "Inception"                                                           
##  [14] "The Lord of the Rings: The Two Towers"                               
...
```
]
.pull-right[
&lt;img src="img/titles.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

class: middle

# Step 3. Scrape year movies were made and save as `years`

---

## Scrape years movies were made in

&lt;img src="img/years.png" width="70%" style="display: block; margin: auto;" /&gt;

---

## Scrape the nodes

.pull-left[

```r
page %&gt;%
  html_nodes(".secondaryInfo")
```

```
## {xml_nodeset (250)}
##  [1] &lt;span class="secondaryInfo"&gt;(1994)&lt;/span&gt;
##  [2] &lt;span class="secondaryInfo"&gt;(1972)&lt;/span&gt;
##  [3] &lt;span class="secondaryInfo"&gt;(1974)&lt;/span&gt;
##  [4] &lt;span class="secondaryInfo"&gt;(2008)&lt;/span&gt;
##  [5] &lt;span class="secondaryInfo"&gt;(1957)&lt;/span&gt;
##  [6] &lt;span class="secondaryInfo"&gt;(1993)&lt;/span&gt;
##  [7] &lt;span class="secondaryInfo"&gt;(2003)&lt;/span&gt;
##  [8] &lt;span class="secondaryInfo"&gt;(1994)&lt;/span&gt;
##  [9] &lt;span class="secondaryInfo"&gt;(1966)&lt;/span&gt;
## [10] &lt;span class="secondaryInfo"&gt;(2001)&lt;/span&gt;
## [11] &lt;span class="secondaryInfo"&gt;(1999)&lt;/span&gt;
## [12] &lt;span class="secondaryInfo"&gt;(1994)&lt;/span&gt;
## [13] &lt;span class="secondaryInfo"&gt;(2010)&lt;/span&gt;
## [14] &lt;span class="secondaryInfo"&gt;(2002)&lt;/span&gt;
## [15] &lt;span class="secondaryInfo"&gt;(1980)&lt;/span&gt;
## [16] &lt;span class="secondaryInfo"&gt;(1999)&lt;/span&gt;
...
```
]
.pull-right[
&lt;img src="img/years.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Extract the text from the nodes

.pull-left[

```r
page %&gt;%
  html_nodes(".secondaryInfo") %&gt;%
  html_text()
```

```
##   [1] "(1994)" "(1972)" "(1974)" "(2008)" "(1957)" "(1993)"
##   [7] "(2003)" "(1994)" "(1966)" "(2001)" "(1999)" "(1994)"
##  [13] "(2010)" "(2002)" "(1980)" "(1999)" "(1990)" "(1975)"
##  [19] "(1954)" "(1995)" "(1991)" "(2002)" "(1997)" "(1946)"
##  [25] "(1998)" "(1977)" "(2014)" "(2001)" "(1999)" "(2021)"
##  [31] "(2019)" "(1994)" "(1962)" "(2002)" "(1991)" "(1985)"
##  [37] "(1995)" "(1994)" "(1960)" "(1936)" "(1988)" "(1998)"
##  [43] "(2014)" "(2000)" "(2006)" "(1931)" "(2011)" "(2006)"
##  [49] "(1942)" "(1968)" "(1954)" "(1988)" "(1979)" "(1979)"
##  [55] "(2000)" "(1981)" "(1940)" "(2012)" "(2006)" "(1957)"
##  [61] "(1950)" "(2008)" "(2018)" "(1957)" "(2018)" "(1980)"
##  [67] "(1964)" "(1997)" "(2003)" "(2019)" "(2016)" "(2017)"
##  [73] "(2012)" "(1986)" "(1984)" "(2019)" "(2018)" "(1981)"
##  [79] "(1963)" "(2009)" "(1995)" "(1984)" "(1999)" "(1995)"
##  [85] "(2009)" "(1997)" "(2020)" "(1985)" "(1983)" "(1968)"
##  [91] "(1992)" "(2007)" "(1958)" "(1931)" "(2012)" "(1941)"
...
```
]
.pull-right[
&lt;img src="img/years.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Clean up the text

We need to go from `"(1994)"` to `1994`:

- Remove `(` and `)`: string manipulation

- Convert to numeric: `as.numeric()`

---

## stringr

.pull-left-wide[
- **stringr** provides a cohesive set of functions designed to make working with strings as easy as possible
- Functions in stringr start with `str_*()`, e.g.
  - `str_remove()` to remove a pattern from a string
  
  ```r
  str_remove(string = "jello", pattern = "el")
  ```
  
  ```
  ## [1] "jlo"
  ```
  - `str_replace()` to replace a pattern with another
  
  ```r
  str_replace(string = "jello", pattern = "j", replacement = "h")
  ```
  
  ```
  ## [1] "hello"
  ```
]
.pull-right-narrow[
&lt;img src="img/stringr.png" width="100%" style="display: block; margin: auto auto auto 0;" /&gt;
]

---

## Clean up the text


```r
page %&gt;%
  html_nodes(".secondaryInfo") %&gt;%
  html_text() %&gt;%
  str_remove("\\(") # remove (
```

```
##   [1] "1994)" "1972)" "1974)" "2008)" "1957)" "1993)" "2003)"
##   [8] "1994)" "1966)" "2001)" "1999)" "1994)" "2010)" "2002)"
##  [15] "1980)" "1999)" "1990)" "1975)" "1954)" "1995)" "1991)"
##  [22] "2002)" "1997)" "1946)" "1998)" "1977)" "2014)" "2001)"
##  [29] "1999)" "2021)" "2019)" "1994)" "1962)" "2002)" "1991)"
##  [36] "1985)" "1995)" "1994)" "1960)" "1936)" "1988)" "1998)"
##  [43] "2014)" "2000)" "2006)" "1931)" "2011)" "2006)" "1942)"
##  [50] "1968)" "1954)" "1988)" "1979)" "1979)" "2000)" "1981)"
##  [57] "1940)" "2012)" "2006)" "1957)" "1950)" "2008)" "2018)"
##  [64] "1957)" "2018)" "1980)" "1964)" "1997)" "2003)" "2019)"
##  [71] "2016)" "2017)" "2012)" "1986)" "1984)" "2019)" "2018)"
##  [78] "1981)" "1963)" "2009)" "1995)" "1984)" "1999)" "1995)"
##  [85] "2009)" "1997)" "2020)" "1985)" "1983)" "1968)" "1992)"
##  [92] "2007)" "1958)" "1931)" "2012)" "1941)" "1952)" "2000)"
##  [99] "1959)" "1952)" "2004)" "1948)" "1962)" "1921)" "1987)"
...
```

---

## Clean up the text


```r
page %&gt;%
  html_nodes(".secondaryInfo") %&gt;%
  html_text() %&gt;%
  str_remove("\\(") %&gt;% # remove (
  str_remove("\\)") # remove )
```

```
##   [1] "1994" "1972" "1974" "2008" "1957" "1993" "2003" "1994"
##   [9] "1966" "2001" "1999" "1994" "2010" "2002" "1980" "1999"
##  [17] "1990" "1975" "1954" "1995" "1991" "2002" "1997" "1946"
##  [25] "1998" "1977" "2014" "2001" "1999" "2021" "2019" "1994"
##  [33] "1962" "2002" "1991" "1985" "1995" "1994" "1960" "1936"
##  [41] "1988" "1998" "2014" "2000" "2006" "1931" "2011" "2006"
##  [49] "1942" "1968" "1954" "1988" "1979" "1979" "2000" "1981"
##  [57] "1940" "2012" "2006" "1957" "1950" "2008" "2018" "1957"
##  [65] "2018" "1980" "1964" "1997" "2003" "2019" "2016" "2017"
##  [73] "2012" "1986" "1984" "2019" "2018" "1981" "1963" "2009"
##  [81] "1995" "1984" "1999" "1995" "2009" "1997" "2020" "1985"
##  [89] "1983" "1968" "1992" "2007" "1958" "1931" "2012" "1941"
##  [97] "1952" "2000" "1959" "1952" "2004" "1948" "1962" "1921"
## [105] "1987" "2010" "2016" "1960" "1944" "1927" "1971" "1976"
...
```

---

## Convert to numeric


```r
page %&gt;%
  html_nodes(".secondaryInfo") %&gt;%
  html_text() %&gt;%
  str_remove("\\(") %&gt;% # remove (
  str_remove("\\)") %&gt;% # remove )
  as.numeric()
```

```
##   [1] 1994 1972 1974 2008 1957 1993 2003 1994 1966 2001 1999 1994
##  [13] 2010 2002 1980 1999 1990 1975 1954 1995 1991 2002 1997 1946
##  [25] 1998 1977 2014 2001 1999 2021 2019 1994 1962 2002 1991 1985
##  [37] 1995 1994 1960 1936 1988 1998 2014 2000 2006 1931 2011 2006
##  [49] 1942 1968 1954 1988 1979 1979 2000 1981 1940 2012 2006 1957
##  [61] 1950 2008 2018 1957 2018 1980 1964 1997 2003 2019 2016 2017
##  [73] 2012 1986 1984 2019 2018 1981 1963 2009 1995 1984 1999 1995
##  [85] 2009 1997 2020 1985 1983 1968 1992 2007 1958 1931 2012 1941
##  [97] 1952 2000 1959 1952 2004 1948 1962 1921 1987 2010 2016 1960
## [109] 1944 1927 1971 1976 2020 1973 2011 1983 2000 2019 2001 1962
## [121] 2010 1965 2009 1955 1989 1995 1997 1985 1988 1961 2018 1950
## [133] 2004 1950 1975 1959 2005 2021 1992 1997 2004 2013 1961 2007
## [145] 1995 1963 1948 2006 2001 2009 1980 1974 1988 2010 1998 2007
...
```

---

## Save as `years`

.pull-left[

```r
years &lt;- page %&gt;%
  html_nodes(".secondaryInfo") %&gt;%
  html_text() %&gt;%
  str_remove("\\(") %&gt;% # remove (
  str_remove("\\)") %&gt;% # remove )
  as.numeric()

years
```

```
##   [1] 1994 1972 1974 2008 1957 1993 2003 1994 1966 2001 1999 1994
##  [13] 2010 2002 1980 1999 1990 1975 1954 1995 1991 2002 1997 1946
##  [25] 1998 1977 2014 2001 1999 2021 2019 1994 1962 2002 1991 1985
##  [37] 1995 1994 1960 1936 1988 1998 2014 2000 2006 1931 2011 2006
##  [49] 1942 1968 1954 1988 1979 1979 2000 1981 1940 2012 2006 1957
##  [61] 1950 2008 2018 1957 2018 1980 1964 1997 2003 2019 2016 2017
##  [73] 2012 1986 1984 2019 2018 1981 1963 2009 1995 1984 1999 1995
##  [85] 2009 1997 2020 1985 1983 1968 1992 2007 1958 1931 2012 1941
##  [97] 1952 2000 1959 1952 2004 1948 1962 1921 1987 2010 2016 1960
## [109] 1944 1927 1971 1976 2020 1973 2011 1983 2000 2019 2001 1962
## [121] 2010 1965 2009 1955 1989 1995 1997 1985 1988 1961 2018 1950
...
```
]
.pull-right[
&lt;img src="img/years.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

class: middle

# Step 4. Scrape IMDB ratings and save as `ratings`

---

## Scrape IMDB ratings

&lt;img src="img/ratings.png" width="70%" style="display: block; margin: auto;" /&gt;

---

## Scrape the nodes

.pull-left[

```r
page %&gt;%
  html_nodes("strong")
```

```
## {xml_nodeset (250)}
##  [1] &lt;strong title="9.2 based on 2,545,876 user ratings"&gt;9.2&lt;/ ...
##  [2] &lt;strong title="9.1 based on 1,751,329 user ratings"&gt;9.1&lt;/ ...
##  [3] &lt;strong title="9.0 based on 1,214,561 user ratings"&gt;9.0&lt;/ ...
##  [4] &lt;strong title="9.0 based on 2,496,211 user ratings"&gt;9.0&lt;/ ...
##  [5] &lt;strong title="8.9 based on 752,273 user ratings"&gt;8.9&lt;/st ...
##  [6] &lt;strong title="8.9 based on 1,299,513 user ratings"&gt;8.9&lt;/ ...
##  [7] &lt;strong title="8.9 based on 1,754,923 user ratings"&gt;8.9&lt;/ ...
##  [8] &lt;strong title="8.8 based on 1,958,227 user ratings"&gt;8.8&lt;/ ...
##  [9] &lt;strong title="8.8 based on 734,465 user ratings"&gt;8.8&lt;/st ...
## [10] &lt;strong title="8.8 based on 1,776,703 user ratings"&gt;8.8&lt;/ ...
## [11] &lt;strong title="8.7 based on 2,003,981 user ratings"&gt;8.7&lt;/ ...
## [12] &lt;strong title="8.7 based on 1,964,460 user ratings"&gt;8.7&lt;/ ...
## [13] &lt;strong title="8.7 based on 2,235,964 user ratings"&gt;8.7&lt;/ ...
## [14] &lt;strong title="8.7 based on 1,585,597 user ratings"&gt;8.7&lt;/ ...
## [15] &lt;strong title="8.7 based on 1,234,290 user ratings"&gt;8.7&lt;/ ...
## [16] &lt;strong title="8.7 based on 1,836,608 user ratings"&gt;8.7&lt;/ ...
...
```
]
.pull-right[
&lt;img src="img/ratings.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Extract the text from the nodes

.pull-left[

```r
page %&gt;%
  html_nodes("strong") %&gt;%
  html_text()
```

```
##   [1] "9.2" "9.1" "9.0" "9.0" "8.9" "8.9" "8.9" "8.8" "8.8" "8.8"
##  [11] "8.7" "8.7" "8.7" "8.7" "8.7" "8.7" "8.6" "8.6" "8.6" "8.6"
##  [21] "8.6" "8.6" "8.6" "8.6" "8.6" "8.5" "8.5" "8.5" "8.5" "8.5"
##  [31] "8.5" "8.5" "8.5" "8.5" "8.5" "8.5" "8.5" "8.5" "8.5" "8.5"
##  [41] "8.5" "8.5" "8.5" "8.5" "8.5" "8.5" "8.5" "8.5" "8.4" "8.4"
##  [51] "8.4" "8.4" "8.4" "8.4" "8.4" "8.4" "8.4" "8.4" "8.4" "8.4"
##  [61] "8.4" "8.4" "8.4" "8.4" "8.4" "8.4" "8.4" "8.3" "8.3" "8.3"
##  [71] "8.3" "8.3" "8.3" "8.3" "8.3" "8.3" "8.3" "8.3" "8.3" "8.3"
##  [81] "8.3" "8.3" "8.3" "8.3" "8.3" "8.3" "8.3" "8.3" "8.3" "8.3"
##  [91] "8.3" "8.3" "8.3" "8.3" "8.3" "8.3" "8.3" "8.3" "8.3" "8.3"
## [101] "8.3" "8.3" "8.3" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2"
## [111] "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2"
## [121] "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2"
## [131] "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2"
## [141] "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.2" "8.1" "8.1" "8.1"
## [151] "8.1" "8.1" "8.1" "8.1" "8.1" "8.1" "8.1" "8.1" "8.1" "8.1"
...
```
]
.pull-right[
&lt;img src="img/ratings.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Convert to numeric

.pull-left[

```r
page %&gt;%
  html_nodes("strong") %&gt;%
  html_text() %&gt;%
  as.numeric()
```

```
##   [1] 9.2 9.1 9.0 9.0 8.9 8.9 8.9 8.8 8.8 8.8 8.7 8.7 8.7 8.7 8.7
##  [16] 8.7 8.6 8.6 8.6 8.6 8.6 8.6 8.6 8.6 8.6 8.5 8.5 8.5 8.5 8.5
##  [31] 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5
##  [46] 8.5 8.5 8.5 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4
##  [61] 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3
##  [76] 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3
##  [91] 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.2 8.2
## [106] 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2
## [121] 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2
## [136] 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.1 8.1 8.1
## [151] 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1
## [166] 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1
## [181] 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1
## [196] 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1
## [211] 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.0
...
```
]
.pull-right[
&lt;img src="img/ratings.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

## Save as `ratings`

.pull-left[

```r
ratings &lt;- page %&gt;%
  html_nodes("strong") %&gt;%
  html_text() %&gt;%
  as.numeric()

ratings
```

```
##   [1] 9.2 9.1 9.0 9.0 8.9 8.9 8.9 8.8 8.8 8.8 8.7 8.7 8.7 8.7 8.7
##  [16] 8.7 8.6 8.6 8.6 8.6 8.6 8.6 8.6 8.6 8.6 8.5 8.5 8.5 8.5 8.5
##  [31] 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5 8.5
##  [46] 8.5 8.5 8.5 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.4
##  [61] 8.4 8.4 8.4 8.4 8.4 8.4 8.4 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3
##  [76] 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3
##  [91] 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.3 8.2 8.2
## [106] 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2
## [121] 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2
## [136] 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.2 8.1 8.1 8.1
## [151] 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1
## [166] 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1 8.1
...
```
]
.pull-right[
&lt;img src="img/ratings.png" width="100%" style="display: block; margin: auto;" /&gt;
]

---

class: middle

# Step 5. Create a data frame called `imdb_top_250`

---

## Create a data frame: `imdb_top_250`


```r
imdb_top_250 &lt;- tibble(
  title = titles,
  year = years,
  rating = ratings
)

imdb_top_250
```

```
## # A tibble: 250 x 3
##   title                     year rating
##   &lt;chr&gt;                    &lt;dbl&gt;  &lt;dbl&gt;
## 1 The Shawshank Redemption  1994    9.2
## 2 The Godfather             1972    9.1
## 3 The Godfather: Part II    1974    9  
## 4 The Dark Knight           2008    9  
## 5 12 Angry Men              1957    8.9
## 6 Schindler's List          1993    8.9
## # ... with 244 more rows
```

---

<div id="htmlwidget-1b4ff99564eb6e8884a5" style="width:100%;height:400px;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1b4ff99564eb6e8884a5">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250"],["The Shawshank Redemption","The Godfather","The Godfather: Part II","The Dark Knight","12 Angry Men","Schindler's List","The Lord of the Rings: The Return of the King","Pulp Fiction","The Good, the Bad and the Ugly","The Lord of the Rings: The Fellowship of the Ring","Fight Club","Forrest Gump","Inception","The Lord of the Rings: The Two Towers","Star Wars: Episode V - The Empire Strikes Back","The Matrix","Goodfellas","One Flew Over the Cuckoo's Nest","Seven Samurai","Se7en","The Silence of the Lambs","City of God","Life Is Beautiful","It's a Wonderful Life","Saving Private Ryan","Star Wars: Episode IV - A New Hope","Interstellar","Spirited Away","The Green Mile","Spider-Man: No Way Home","Parasite","Léon: The Professional","Hara-Kiri","The Pianist","Terminator 2: Judgment Day","Back to the Future","The Usual Suspects","The Lion King","Psycho","Modern Times","Grave of the Fireflies","American History X","Whiplash","Gladiator","The Departed","City Lights","The Intouchables","The Prestige","Casablanca","Once Upon a Time in the West","Rear Window","Cinema Paradiso","Alien","Apocalypse Now","Memento","Indiana Jones and the Raiders of the Lost Ark","The Great Dictator","Django Unchained","The Lives of Others","Paths of Glory","Sunset Blvd.","WALL·E","Avengers: Infinity War","Witness for the Prosecution","Spider-Man: Into the Spider-Verse","The Shining","Dr. Strangelove or: How I Learned to Stop Worrying and Love the Bomb","Princess Mononoke","Oldboy","Joker","Your Name.","Coco","The Dark Knight Rises","Aliens","Once Upon a Time in America","Avengers: Endgame","Capernaum","Das Boot","High and Low","3 Idiots","Toy Story","Amadeus","American Beauty","Braveheart","Inglourious Basterds","Good Will Hunting","Hamilton","Come and See","Star Wars: Episode VI - Return of the Jedi","2001: A Space Odyssey","Reservoir Dogs","Like Stars on Earth","Vertigo","M","The Hunt","Citizen Kane","Singin' in the Rain","Requiem for a Dream","North by Northwest","Ikiru","Eternal Sunshine of the Spotless Mind","Bicycle Thieves","Lawrence of Arabia","The Kid","Full Metal Jacket","Incendies","Dangal","The Apartment","Double Indemnity","Metropolis","A Clockwork Orange","Taxi Driver","The Father","The Sting","A Separation","Scarface","Snatch","1917","Amélie","To Kill a Mockingbird","Toy Story 3","For a Few Dollars More","Up","Pather Panchali","Indiana Jones and the Last Crusade","Heat","L.A. Confidential","Ran","Die Hard","Yojimbo","Green Book","Rashomon","Downfall","All About Eve","Monty Python and the Holy Grail","Some Like It Hot","Batman Begins","Jai Bhim","Unforgiven","Children of Heaven","Howl's Moving Castle","The Wolf of Wall Street","Judgment at Nuremberg","There Will Be Blood","Casino","The Great Escape","The Treasure of the Sierra Madre","Pan's Labyrinth","A Beautiful Mind","The Secret in Their Eyes","Raging Bull","Chinatown","My Neighbor Totoro","Shutter Island","Lock, Stock and Two Smoking Barrels","No Country for Old Men","Klaus","Dial M for Murder","The Thing","The Gold Rush","Three Billboards Outside Ebbing, Missouri","The Seventh Seal","The Elephant Man","The Sixth Sense","Dersu Uzala","Jurassic Park","The Truman Show","Wild Strawberries","The Third Man","Memories of Murder","V for Vendetta","Blade Runner","Trainspotting","Fargo","The Bridge on the River Kwai","Inside Out","Finding Nemo","Kill Bill: Vol. 1","Warrior","Gone with the Wind","Tokyo Story","On the Waterfront","My Father and My Son","Prisoners","Wild Tales","The Grand Budapest Hotel","Stalker","The Deer Hunter","The General","Gran Torino","Persona","Sherlock Jr.","Before Sunrise","Catch Me If You Can","Mary and Max","Mr. Smith Goes to Washington","Barry Lyndon","In the Name of the Father","Hacksaw Ridge","Gone Girl","Room","Z","Andhadhun","The Passion of Joan of Arc","Dune","Ford v Ferrari","12 Years a Slave","To Be or Not to Be","The Big Lebowski","Dead Poets Society","Harry Potter and the Deathly Hallows: Part 2","Ben-Hur","How to Train Your Dragon","Mad Max: Fury Road","Autumn Sonata","Million Dollar Baby","The Wages of Fear","Stand by Me","Network","The Handmaiden","Logan","Gangs of Wasseypur","La Haine","A Silent Voice: The Movie","Cool Hand Luke","Hachi: A Dog's Tale","The 400 Blows","Platoon","Spotlight","Monsters, Inc.","Rebecca","Life of Brian","In the Mood for Love","The Bandit","Hotel Rwanda","Rush","Rocky","Demon Slayer: Mugen Train","Amores perros","Into the Wild","Nausicaä of the Valley of the Wind","Drishyam","Before Sunset","It Happened One Night","Miracle in Cell No. 7","Andrei Rublev","The Battle of Algiers","Nights of Cabiria","Fanny and Alexander","Hera Pheri"],[1994,1972,1974,2008,1957,1993,2003,1994,1966,2001,1999,1994,2010,2002,1980,1999,1990,1975,1954,1995,1991,2002,1997,1946,1998,1977,2014,2001,1999,2021,2019,1994,1962,2002,1991,1985,1995,1994,1960,1936,1988,1998,2014,2000,2006,1931,2011,2006,1942,1968,1954,1988,1979,1979,2000,1981,1940,2012,2006,1957,1950,2008,2018,1957,2018,1980,1964,1997,2003,2019,2016,2017,2012,1986,1984,2019,2018,1981,1963,2009,1995,1984,1999,1995,2009,1997,2020,1985,1983,1968,1992,2007,1958,1931,2012,1941,1952,2000,1959,1952,2004,1948,1962,1921,1987,2010,2016,1960,1944,1927,1971,1976,2020,1973,2011,1983,2000,2019,2001,1962,2010,1965,2009,1955,1989,1995,1997,1985,1988,1961,2018,1950,2004,1950,1975,1959,2005,2021,1992,1997,2004,2013,1961,2007,1995,1963,1948,2006,2001,2009,1980,1974,1988,2010,1998,2007,2019,1954,1982,1925,2017,1957,1980,1999,1975,1993,1998,1957,1949,2003,2005,1982,1996,1996,1957,2015,2003,2003,2011,1939,1953,1954,2005,2013,2014,2014,1979,1978,1926,2008,1966,1924,1995,2002,2009,1939,1975,1993,2016,2014,2015,1969,2018,1928,2021,2019,2013,1942,1998,1989,2011,1959,2010,2015,1978,2004,1953,1986,1976,2016,2017,2012,1995,2016,1967,2009,1959,1986,2015,2001,1940,1979,2000,1996,2004,2013,1976,2020,2000,2007,1984,2013,2004,1934,2019,1966,1966,1957,1982,2000],[9.2,9.1,9,9,8.9,8.9,8.9,8.8,8.8,8.8,8.7,8.7,8.7,8.7,8.7,8.7,8.6,8.6,8.6,8.6,8.6,8.6,8.6,8.6,8.6,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.5,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.4,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.3,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.2,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8.1,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>title<\/th>\n      <th>year<\/th>\n      <th>rating<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

---

## Clean up / enhance

May or may not be a lot of work depending on how messy the data are

- See if you like what you got:


```r
glimpse(imdb_top_250)
```

```
## Rows: 250
## Columns: 3
## $ title  &lt;chr&gt; "The Shawshank Redemption", "The Godfather", "Th~
## $ year   &lt;dbl&gt; 1994, 1972, 1974, 2008, 1957, 1993, 2003, 1994, ~
## $ rating &lt;dbl&gt; 9.2, 9.1, 9.0, 9.0, 8.9, 8.9, 8.9, 8.8, 8.8, 8.8~
```

- Add a variable for rank

```r
imdb_top_250 &lt;- imdb_top_250 %&gt;%
  mutate(rank = 1:nrow(imdb_top_250)) %&gt;%
  relocate(rank)
```

---


```
## # A tibble: 250 x 4
##     rank title                                        year rating
##    &lt;int&gt; &lt;chr&gt;                                       &lt;dbl&gt;  &lt;dbl&gt;
##  1     1 The Shawshank Redemption                     1994    9.2
##  2     2 The Godfather                                1972    9.1
##  3     3 The Godfather: Part II                       1974    9  
##  4     4 The Dark Knight                              2008    9  
##  5     5 12 Angry Men                                 1957    8.9
##  6     6 Schindler's List                             1993    8.9
##  7     7 The Lord of the Rings: The Return of the K~  2003    8.9
##  8     8 Pulp Fiction                                 1994    8.8
##  9     9 The Good, the Bad and the Ugly               1966    8.8
## 10    10 The Lord of the Rings: The Fellowship of t~  2001    8.8
## 11    11 Fight Club                                   1999    8.7
## 12    12 Forrest Gump                                 1994    8.7
## 13    13 Inception                                    2010    8.7
## 14    14 The Lord of the Rings: The Two Towers        2002    8.7
## 15    15 Star Wars: Episode V - The Empire Strikes ~  1980    8.7
## 16    16 The Matrix                                   1999    8.7
## 17    17 Goodfellas                                   1990    8.6
## 18    18 One Flew Over the Cuckoo's Nest              1975    8.6
## 19    19 Seven Samurai                                1954    8.6
## 20    20 Se7en                                        1995    8.6
## # ... with 230 more rows
```

---

class: middle

# What next?

---

.question[
Which years have the most movies on the list?
]

--


```r
imdb_top_250 %&gt;%
  count(year, sort = TRUE)
```

```
## # A tibble: 86 x 2
##    year     n
##   &lt;dbl&gt; &lt;int&gt;
## 1  1995     8
## 2  1957     7
## 3  2000     7
## 4  2019     7
## 5  2004     6
## 6  2009     6
## # ... with 80 more rows
```

---

.question[
Which 1995 movies made the list?
]

--


```r
imdb_top_250 %&gt;%
  filter(year == 1995) %&gt;%
  print(n = 8)
```

```
## # A tibble: 8 x 4
##    rank title               year rating
##   &lt;int&gt; &lt;chr&gt;              &lt;dbl&gt;  &lt;dbl&gt;
## 1    20 Se7en               1995    8.6
## 2    37 The Usual Suspects  1995    8.5
## 3    81 Toy Story           1995    8.3
## 4    84 Braveheart          1995    8.3
## 5   126 Heat                1995    8.2
## 6   145 Casino              1995    8.2
## 7   193 Before Sunrise      1995    8.1
## 8   223 La Haine            1995    8.1
```

---

.question[
Visualize the average yearly rating for movies that made it on the top 250 list over time.
]

--

.panelset[
.panel[.panel-name[Plot]
&lt;img src="index_files/figure-html/unnamed-chunk-55-1.png" width="58%" style="display: block; margin: auto;" /&gt;
]
.panel[.panel-name[Code]


```r
imdb_top_250 %&gt;%
  group_by(year) %&gt;%
  summarise(avg_score = mean(rating)) %&gt;%
  ggplot(aes(y = avg_score, x = year)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(x = "Year", y = "Average score")
```
]
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightLines": true,
"highlightStyle": "solarized-light",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
